{"ast":null,"code":"import _objectSpread from\"/projects/udemy/e-catalog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/projects/udemy/e-catalog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(singInAfterSignUp),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from'redux-saga/effects';import UserActionTypes from'./user.types';import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.utils';import{signInSuccess,signInFailure,signOutFailure,signOutSuccess,signUpFailure,signUpSuccess}from'./user.actions';function signUp(_ref){var _ref$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password,displayName=_ref$payload.displayName;_context.prev=1;_context.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context.sent;user=_yield$auth$createUse.user;_context.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);_context.next=14;return put(signUpFailure(_context.t0));case 14:case\"end\":return _context.stop();}}},_marked,null,[[1,10]]);}function singInAfterSignUp(_ref2){var _ref2$payload,user,additionalData;return _regeneratorRuntime.wrap(function singInAfterSignUp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref2$payload=_ref2.payload,user=_ref2$payload.user,additionalData=_ref2$payload.additionalData;_context2.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context2.stop();}}},_marked2);}function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context3.sent;_context3.next=6;return userRef.get();case 6:userSnapshot=_context3.sent;_context3.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context3.next=15;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](0);_context3.next=15;return put(signInFailure(_context3.t0));case 15:case\"end\":return _context3.stop();}}},_marked3,null,[[0,11]]);}function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context4.sent;user=_yield$auth$signInWit.user;_context4.next=7;return getSnapshotFromUserAuth(user);case 7:_context4.next=13;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);_context4.next=13;return put(signInFailure(_context4.t0));case 13:case\"end\":return _context4.stop();}}},_marked4,null,[[0,9]]);}function signInWithEmail(_ref3){var _ref3$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_ref3$payload=_ref3.payload,email=_ref3$payload.email,password=_ref3$payload.password;_context5.prev=1;_context5.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context5.sent;user=_yield$auth$signInWit2.user;_context5.next=8;return getSnapshotFromUserAuth(user);case 8:_context5.next=14;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](1);_context5.next=14;return put(signInFailure(_context5.t0));case 14:case\"end\":return _context5.stop();}}},_marked5,null,[[1,10]]);}function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signInFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return auth.signOut();case 3:_context7.next=5;return put(signOutSuccess());case 5:_context7.next=11;break;case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](0);_context7.next=11;return put(signOutFailure());case 11:case\"end\":return _context7.stop();}}},_marked7,null,[[0,7]]);}function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);}function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);}function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context10.stop();}}},_marked10);}function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context11.stop();}}},_marked11);}function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,singInAfterSignUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onSignOutStart),call(onSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["/projects/udemy/e-catalog/client/src/redux/user/user.sagas.js"],"names":["signUp","singInAfterSignUp","getSnapshotFromUserAuth","signInWithGoogle","signInWithEmail","isUserAuthenticated","signOut","onGoogleSignInStart","onEmailSignInStart","onCheckUserSession","onSignOutStart","onSignUpStart","onSignUpSuccess","userSagas","takeLatest","put","all","call","UserActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","signInSuccess","signInFailure","signOutFailure","signOutSuccess","signUpFailure","signUpSuccess","payload","email","password","displayName","createUserWithEmailAndPassword","user","additionalData","userAuth","userRef","get","userSnapshot","id","data","signInWithPopup","signInWithEmailAndPassword","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START","SIGN_UP_START","SIGN_UP_SUCCESS"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from 'redux-saga/effects'\nimport UserActionTypes from './user.types';\nimport { auth, googleProvider, createUserProfileDocument, getCurrentUser } from '../../firebase/firebase.utils'\nimport { signInSuccess, signInFailure, signOutFailure, signOutSuccess, signUpFailure, signUpSuccess } from './user.actions'\n\n\nfunction* signUp({ payload: { email, password, displayName } }) {\n    try {\n        const { user } = yield auth.createUserWithEmailAndPassword(email, password)\n        yield put(signUpSuccess({ user, additionalData: { displayName } }))\n\n    } catch (error) {\n        yield put(signUpFailure(error))\n    }\n}\n\nfunction* singInAfterSignUp({ payload: { user, additionalData } }) {\n    yield getSnapshotFromUserAuth(user, additionalData)\n}\n\nfunction* getSnapshotFromUserAuth(userAuth, additionalData) {\n    try {\n        const userRef = yield call(createUserProfileDocument, userAuth, additionalData)\n        const userSnapshot = yield userRef.get()\n        yield put(signInSuccess({ id: userSnapshot.id, ...userSnapshot.data() }))\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nfunction* signInWithGoogle() {\n    try {\n        const { user } = yield auth.signInWithPopup(googleProvider)\n        yield getSnapshotFromUserAuth(user)\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nfunction* signInWithEmail({ payload: { email, password } }) {\n    try {\n        const { user } = yield auth.signInWithEmailAndPassword(email, password)\n        yield getSnapshotFromUserAuth(user)\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nfunction* isUserAuthenticated() {\n    try {\n        const userAuth = yield getCurrentUser()\n        if (!userAuth) return\n        yield getSnapshotFromUserAuth(userAuth)\n    } catch (error) {\n        yield put(signInFailure(error))\n    }\n}\n\nfunction* signOut() {\n    try {\n        yield auth.signOut()\n        yield put(signOutSuccess())\n    } catch (error) {\n        yield put(signOutFailure())\n    }\n}\n\n\nfunction* onGoogleSignInStart() {\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle)\n}\n\nfunction* onEmailSignInStart() {\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signInWithEmail)\n}\n\nfunction* onCheckUserSession() {\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated)\n}\n\nfunction* onSignOutStart() {\n    yield takeLatest(UserActionTypes.SIGN_OUT_START, signOut)\n}\n\nfunction* onSignUpStart() {\n    yield takeLatest(UserActionTypes.SIGN_UP_START, signUp)\n}\n\nfunction* onSignUpSuccess() {\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS, singInAfterSignUp)\n}\n\n\nexport function* userSagas() {\n    yield all([\n        call(onGoogleSignInStart),\n        call(onEmailSignInStart),\n        call(onCheckUserSession),\n        call(onSignOutStart),\n        call(onSignUpStart),\n        call(onSignUpSuccess)\n    ])\n} \n"]},"metadata":{},"sourceType":"module"}